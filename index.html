<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compiled Status Form</title>
</head>
<body>
    <h1>Compiled Status Form</h1>
    <form id="statusForm">
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br>

        <label for="status">Status:</label>
        <select id="status" name="status" required>
            <option value="">Select...</option>
            <option value="Compiled">Compiled</option>
            <option value="Not Compiled">Not Compiled</option>
        </select><br>

        <label for="comment">Comment:</label>
        <textarea id="comment" name="comment" required></textarea><br>

        <label for="fileUpload">File Upload:</label>
        <input type="file" id="fileUpload" name="fileUpload" accept=".pdf,.doc,.docx" required><br>

        <label for="updatedDate">Updated Date:</label>
        <input type="date" id="updatedDate" name="updatedDate"><br>

        <button type="button" onclick="submitForm()">Submit</button>
    </form>

    <script>
        function submitForm() {
            var form = document.getElementById('statusForm');
            var formData = new FormData(form);

            // Convert FormData to JSON
            var jsonData = {};
            formData.forEach(function(value, key) {
                jsonData[key] = value;
            });
            var jsonString = JSON.stringify(jsonData);

            // Send JSON data to Google Apps Script
            google.script.run.doPost(jsonString);
        }
    </script>

    <script src="https://apis.google.com/js/api.js"></script>
</body>
</html>
